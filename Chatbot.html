<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>3D Advanced Chatbot (Single File)</title>
  <style>
    :root{
      --bg:#0f1724;
      --accent:#ff3ca6;
      --muted:#94a3b8;
      --bubble-user:#0b93ff;
      --bubble-assistant:#1e293b;
      font-family: Inter, ui-sans-serif, system-ui;
    }
    html,body{height:100%;margin:0;background:radial-gradient(1200px 600px at 10% 10%, rgba(39,39,58,0.35), transparent), var(--bg);color:#e6eef8}
    .app{display:grid;grid-template-columns:360px 1fr;gap:20px;padding:28px;height:100%;box-sizing:border-box}
    .left{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:18px;box-shadow:0 10px 30px rgba(2,6,23,0.6);display:flex;flex-direction:column;gap:12px}
    .scene{height:320px;display:flex;align-items:center;justify-content:center;perspective:1000px}
    .cube{width:180px;height:180px;transform-style:preserve-3d;animation:spin 10s linear infinite}
    .cube .face{position:absolute;width:100%;height:100%;display:flex;align-items:center;justify-content:center;border-radius:12px;font-weight:700;backface-visibility:hidden;box-shadow:0 8px 24px rgba(2,6,23,0.6)}
    .face.front{transform:translateZ(90px);background:linear-gradient(180deg,var(--accent),#ff7abf);}
    .face.back{transform:rotateY(180deg) translateZ(90px);background:linear-gradient(180deg,#0ea5a9,#14b8a6);}
    .face.right{transform:rotateY(90deg) translateZ(90px);background:linear-gradient(180deg,#3b82f6,#60a5fa);}
    .face.left{transform:rotateY(-90deg) translateZ(90px);background:linear-gradient(180deg,#8b5cf6,#a78bfa);}
    .face.top{transform:rotateX(90deg) translateZ(90px);background:linear-gradient(180deg,#fb923c,#fdba74);}
    .face.bottom{transform:rotateX(-90deg) translateZ(90px);background:linear-gradient(180deg,#10b981,#34d399);}
    @keyframes spin{from{transform:rotateX(0deg) rotateY(0deg)}to{transform:rotateX(360deg) rotateY(360deg)}}

    .right{display:flex;flex-direction:column;height:100%;gap:12px}
    .chat-shell{background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border-radius:14px;padding:18px;display:flex;flex-direction:column;height:100%;box-shadow:inset 0 1px 0 rgba(255,255,255,0.02)}
    .messages{flex:1;overflow:auto;padding:6px;display:flex;flex-direction:column;gap:10px}
    .message{max-width:75%;padding:10px 14px;border-radius:12px;line-height:1.3}
    .user{align-self:flex-end;background:linear-gradient(180deg,var(--bubble-user),#0369a1);color:white;border-bottom-right-radius:6px}
    .assistant{align-self:flex-start;background:linear-gradient(180deg,var(--bubble-assistant),#0f1724);color:#cfe8ff;border-bottom-left-radius:6px}
    .meta{font-size:11px;color:var(--muted);margin-bottom:6px}

    .composer{display:flex;gap:8px;padding-top:8px}
    .input{flex:1;min-height:48px;max-height:200px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:rgba(3,7,18,0.4);outline:none;color:inherit;font-size:14px;resize:none}
    .send{width:56px;display:flex;align-items:center;justify-content:center;border-radius:10px;border:none;background:linear-gradient(180deg,var(--accent),#ff7abf);cursor:pointer}

    .loading-overlay{position:absolute;inset:0;display:none;align-items:center;justify-content:center;pointer-events:none}
    .spinner{width:56px;height:56px;border-radius:50%;border:6px solid rgba(255,255,255,0.06);border-top-color:var(--accent);animation:spin2 1s linear infinite}
    @keyframes spin2{to{transform:rotate(360deg)}}

    @media (max-width:900px){.app{grid-template-columns:1fr;padding:14px}.left{order:2}.right{order:1}}
  </style>
</head>
<body>
  <div class="app">
    <div class="left">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:700;font-size:16px">3D Advanced Chatbot</div>
        <div style="font-size:12px;color:var(--muted)">Powered by OpenRouter</div>
      </div>

      <div class="scene" aria-hidden="true">
        <div class="cube" id="cube">
          <div class="face front">Ask Your Doubt</div>
          <div class="face back">AI</div>
          <div class="face right">Chat</div>
          <div class="face left">3D</div>
          <div class="face top">TS</div>
          <div class="face bottom">Web</div>
        </div>
      </div>
    </div>

    <div class="right">
      <div class="chat-shell" id="chatShell" style="position:relative">
        <div class="loading-overlay" id="loadingOverlay">
          <div class="spinner" role="status"></div>
        </div>
        <div class="messages" id="messages"></div>
        <div class="composer">
          <textarea id="input" class="input" placeholder="Type a message â€” press Enter to send, Shift+Enter for newline"></textarea>
          <button id="sendBtn" class="send">Send</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const OPENROUTER_API_KEY = "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";
    const ENDPOINT = "https://openrouter.ai/api/v1/chat/completions";
    const MODEL = "qwen/qwen2.5-vl-72b-instruct:free";

    const messagesEl = document.getElementById('messages');
    const inputEl = document.getElementById('input');
    const sendBtn = document.getElementById('sendBtn');
    const loadingOverlay = document.getElementById('loadingOverlay');
    const cube = document.getElementById('cube');

    function showLoading(on){ loadingOverlay.style.display = on ? 'flex':'none'; }

    function appendMessage(text, who='assistant'){
      const wrap=document.createElement('div');
      wrap.className='message '+(who==='user'?'user':'assistant');
      const meta=document.createElement('div'); meta.className='meta'; meta.textContent=who==='user'?'You':'Assistant';
      const content=document.createElement('div'); content.innerHTML=text.replace(/\n/g,'<br>');
      wrap.appendChild(meta); wrap.appendChild(content);
      messagesEl.appendChild(wrap);
      messagesEl.scrollTop=messagesEl.scrollHeight;
    }

    async function callOpenRouter(userText){
      const body={ model:MODEL, messages:[{role:'user',content:[{type:'text',text:userText}]}] };
      const res=await fetch(ENDPOINT,{method:'POST',headers:{'Authorization':'Bearer '+OPENROUTER_API_KEY,'Content-Type':'application/json'},body:JSON.stringify(body)});
      const data=await res.json();
      let out='';
      if(data?.choices?.[0]){
        const ch=data.choices[0];
        if(ch.message && Array.isArray(ch.message.content)) out=ch.message.content.map(c=>c.text||'').join('\n');
        else if(ch.message?.content) out=ch.message.content;
      }
      return out;
    }

    async function sendMessage(){
      const text=inputEl.value.trim(); if(!text) return;
      appendMessage(text,'user'); inputEl.value=''; showLoading(true);
      try{ const reply=await callOpenRouter(text); appendMessage(reply,'assistant'); pulseCube(); }
      catch(e){ appendMessage('Error: '+e.message,'assistant'); }
      finally{ showLoading(false); }
    }

    function pulseCube(){ cube.animate([{transform:'scale(1)'},{transform:'scale(1.06)'},{transform:'scale(1)'}],{duration:700,easing:'ease-out'}); }

    sendBtn.addEventListener('click',sendMessage);
    inputEl.addEventListener('keydown',e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendMessage();}});

    appendMessage('Hello! I am your 3D chatbot. Type your question and press Enter.','assistant');
  </script>
</body>
</html>
